<!DOCTYPE html>
<html>

<head>
	<title>Rocketbook Update</title>
	<link rel="manifest" href="/Manifest.json" /> 
	<meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=no">
	<link rel="stylesheet" href="/styles/index.css" />
</head>

<body>
	<img id="logo" src="/images/logo.png" />
	
	<div id="shortcutDiv">
		<p id="openAppLabel">Ouvrir l'application</p>
		
		<a id="shortcutLink" href="https://rocketbook.app.link">
			<img id="shortcutImage" src="/images/shortcut.png">
		</a>
	</div>

	<div id="currentVersionDiv">
		<label>Version actuelle : <span id="currentVersion"></span></label>
	</div>

	<div id="newVersionDiv">
		<label>Nouvelle version : <span id="newVersion"></span> !</label>
	</div>

	<a href='https://play.google.com/store/apps/details?id=com.rb.rocketbook&hl=fr&pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1'>
		<img id="playstoreImage" alt='Disponible sur Google Play' src='https://play.google.com/intl/en_us/badges/static/images/badges/fr_badge_web_generic.png'/>
	</a>
</body>

</html>

<script>
	const mode = navigator.appVersion.includes('Android') ? 'mobile' : 'web';
	document.body.style.background = `url('/images/background_${mode}.png') no-repeat center fixed`;
	document.body.style.backgroundSize = 'cover';

	if (mode == 'web') {
		document.getElementById('shortcutDiv').style.display = 'none';
	}

	var currentVersion = localStorage.getItem('currentVersion');
	const lastVersion = '<%= lastVersion %>';

	if (currentVersion == null) {
		currentVersion = lastVersion;
	}

	localStorage.setItem('currentVersion', lastVersion);

	document.getElementById('currentVersion').textContent = currentVersion;

	if (lastVersion > currentVersion) {
		document.getElementById('newVersionDiv').style.display = 'block';
		document.getElementById('newVersion').textContent = lastVersion;
	}

	navigator.serviceWorker.register('/sw.js').then(function() {
		console.log("Service Worker Registered");
	});
</script>